<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="Jackson"><link rel="icon" href="/headshot_copy.jpg"><title>JacksonJs</title><meta name="description" content="Blog of Jackson Stokes"><link rel="alternate" type="application/rss+xml" title="JacksonJs" href="/atom.xml"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">
</head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">JacksonJs</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/archives">Archive</a></li><li><a href="/about/">About</a></li><li><a href="/contact">Contact</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/headshot_copy.jpg" class="avatar-img"></a></div></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>Let's Encrypt, Docker, and WordPress</h1><p class="post-meta">Posted on Jul 2 2016</p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><p>I had a very specific problem that i wanted to solve: setting up a wordpress installation that had HTTPS, and it had to be inside of a docker container. Wew, tall order!</p>
<p>VERY luckily for me, the project <a href="https://github.com/steveltn/https-portal" target="_blank" rel="external">HTTPS-PORTAL</a> is is working order and being actively developed! </p>
<p>Using <a href="https://letsencrypt.org/" target="_blank" rel="external">Letâ€™s Encryptâ€™s</a> certificate automation, I was able to set up an HTTPS wordpress install in under five minutes. Here are some reasons why sites should be using HTTPS:</p>
<ul>
<li><p>HTTPS helps prevent intruders from tampering with the communications between your websites and your usersâ€™ browsers. Intruders include intentionally malicious attackers, and legitimate but intrusive companies, such as ISPs or hotels that inject ads into pages.</p>
</li>
<li><p>HTTPS prevents intruders from being able to passively listen in on the communications between your websites and your users.</p>
</li>
<li><p>It is much cheaper and faster to imlement because of the Letâ€™s Encrypt project!</p>
</li>
</ul>
<p>I followed <a href="https://steveltn.me/2015/12/18/nginx-acme/" target="_blank" rel="external">this tutorial </a> (currently offline ðŸ˜”) to get me up and running with my wordpress install. I had some problems understanding how to write a docker-compose file, but the blog author was very quick assisting to correct my mistakes. </p>
<p>Here is what my docker-compose.yml file contained, minus the real password:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"># docker-compose.yml for my_wordpress site</div><div class="line"></div><div class="line">https-portal:</div><div class="line">  image: steveltn/https-portal</div><div class="line">  ports:</div><div class="line">    - 80:80</div><div class="line">    - 443:443</div><div class="line">  links:</div><div class="line">    - wordpress</div><div class="line">  environment:</div><div class="line">    - &quot;DOMAINS=containerize.us -&gt; http://wordpress&quot; #maps https-portal to the wordpress image</div><div class="line">    - &quot;PRODUCTION=true&quot; #ensures that the certificate will be recognized as valid by web browsers</div><div class="line"></div><div class="line">wordpress:</div><div class="line">  image: wordpress</div><div class="line">  links:</div><div class="line">    - db:mysql</div><div class="line"></div><div class="line">db:</div><div class="line">  image: mariadb</div><div class="line">  ports:</div><div class="line">    - 3306:3306</div><div class="line">  environment:</div><div class="line">    MYSQL_ROOT_PASSWORD: &apos;&lt;secure_password&gt;&apos;</div></pre></td></tr></table></figure>
<p>After the server generates a TLS diffie-hellman key and spins up the WordPress instance, we have our WordPress site installed! </p>
<p>Now letâ€™s insert some media. While you could just embedd everything from an external site like youtube and imagur, it is nice to have the option to host your own assets.  Right now, the upload limit is a puny 2MB. Letâ€™s change it to 64MB.</p>
<p>To enter the container, type:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker <span class="built_in">exec</span> -i -t mywordpress_wordpress_1 bash</div></pre></td></tr></table></figure></p>
<p>To install the nano text editor, type:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get update</div><div class="line">apt-get install nano</div></pre></td></tr></table></figure></p>
<p>Create the file php.ini in you WordPress root directory<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi php.ini</div></pre></td></tr></table></figure></p>
<p>Once in, paste these lines:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">upload_max_filesize = 64M</div><div class="line">post_max_size = 64M</div><div class="line">memory_limit = 64M</div></pre></td></tr></table></figure></p>
<p>Stop the running containers<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker stop mywordpress_db_1 mywordpress_https-portal_1 mywordpress_wordpress_1</div></pre></td></tr></table></figure></p>
<p>In the directory you put docker-compose.yml, run:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker-compose up -d</div></pre></td></tr></table></figure></p>
<p>Hooray, our upload limit is now increased! We can now upload media up to 64MB.</p>
<p>You can visit the site I generated this way at <a href="https://containerize.us" target="_blank" rel="external">https://containerize.us</a></p>
</article><ul class="pager blog-pager"><li class="previous"><a href="/2016/07/06/podcasts/" data-toggle="tooltip" data-placement="top" title="Podcasts">ä¸Šä¸€ç¯‡</a></li><li class="next"><a href="/2016/07/02/hello-world/" data-toggle="tooltip" data-placement="top" title="Hello World">ä¸‹ä¸€ç¯‡</a></li></ul><div class="disqus-comments"><div class="comments"><div id="disqus_thread"></div></div></div><script>var url_parts = window.location.href.split("?");
var disqus_url = url_parts[0];
(function () {
    console.log("enter disqus");
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = "//jacksonjs.disqus.com/embed.js";
    (document.head || d.body ).appendChild(dsq);
})();</script></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="https://github.com/jacksonjs" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="/atom.xml" title="RSS"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-rss"></i></span></a></li><li><a href="https://twitter.com/jstokesjs" title="Twitter"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-twitter"></i></span></a></li><li><a href="mailto:jacksonjs@openmailbox.org" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li></ul><p class="copyright text-muted">Â© Jackson â€¢ 2016 â€¢ <a href="mailto:undefined"></a>
</p></div></div></div></footer><!--                p.theme-by.text-muted.//                  Theme by
  //                <a href="https://github.com/twoyao/beautiful-hexo">beautiful-hexo</a>--><script src="/js/jquery-1.11.2.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script>(function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
    a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-78536565-2', 'auto');
ga('send', 'pageview');</script></body></html>